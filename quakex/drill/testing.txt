-- Global overview statistics with explicit column specification
SELECT 
    COUNT(*) AS total_events,
    ROUND(AVG(`magnitude`), 2) AS avg_magnitude,
    MAX(`magnitude`) AS max_magnitude,
    MIN(`magnitude`) AS min_magnitude,
    ROUND(AVG(`depth`), 1) AS avg_depth,
    MAX(`depth`) AS max_depth,
    MIN(`depth`) AS min_depth,
    '2025-07' AS month
FROM dfs.`/data/earthquakes-2025-07.json`

UNION ALL

SELECT 
    COUNT(*) AS total_events,
    ROUND(AVG(`magnitude`), 2) AS avg_magnitude,
    MAX(`magnitude`) AS max_magnitude,
    MIN(`magnitude`) AS min_magnitude,
    ROUND(AVG(`depth`), 1) AS avg_depth,
    MAX(`depth`) AS max_depth,
    MIN(`depth`) AS min_depth,
    '2025-08' AS month
FROM dfs.`/data/earthquakes-2025-08.json`

UNION ALL

SELECT 
    COUNT(*) AS total_events,
    ROUND(AVG(`magnitude`), 2) AS avg_magnitude,
    MAX(`magnitude`) AS max_magnitude,
    MIN(`magnitude`) AS min_magnitude,
    ROUND(AVG(`depth`), 1) AS avg_depth,
    MAX(`depth`) AS max_depth,
    MIN(`depth`) AS min_depth,
    '2025-09' AS month
FROM dfs.`/data/earthquakes-2025-09.json`;

total_events	avg_magnitude	max_magnitude	min_magnitude	avg_depth	max_depth	min_depth	month
1239	4.87	8.8	4.5	44.0	639	0	2025-07
938	4.79	7.5	4.5	43.3	614	0	2025-08
759	4.8	7.8	4.5	46.9	629	3	2025-09

---

-- Find the 5 strongest earthquake with fallback for null country
SELECT 
    `id`,
    `magnitude`,
    `depth`,
    `place`,
    `time`,
    COALESCE(CAST(`country`['name'] AS VARCHAR), 'International Waters') AS country_name,
    COALESCE(CAST(`country`['region'] AS VARCHAR), 'N/A') AS region
FROM (
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `place`,
        `time`,
        `country`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `place`,
        `time`,
        `country`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `place`,
        `time`,
        `country`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
ORDER BY `magnitude` DESC
LIMIT 5;

id	magnitude	depth	place	time	country_name	region
us6000qw60	8.8	35	2025 Kamchatka Peninsula, Russia Earthquake	2025-07-29T23:24:52.483Z	International Waters	N/A
us7000qx2g	7.8	30	128 km E of Petropavlovsk-Kamchatsky, Russia	2025-09-18T18:58:15.240Z	Russia	Europe
us6000r2xq	7.5	10	2025 Southern Drake Passage Earthquake	2025-08-22T02:16:18.246Z	Falkland Islands	Americas
us7000qdyl	7.4	34	2025 Eastern Kamchatka, Russia Earthquake	2025-07-20T06:49:04.327Z	International Waters	N/A
us7000qvw5	7.4	59	102 km E of Petropavlovsk-Kamchatsky, Russia	2025-09-13T02:37:56.847Z	Russia	Europe

---

-- Top 20 countries (simplified to avoid schema change issues)
SELECT 
    country_name,
    region,
    subregion,
    COUNT(*) AS total_events,
    ROUND(AVG(magnitude_val), 2) AS avg_magnitude,
    MAX(magnitude_val) AS max_magnitude,
    MIN(magnitude_val) AS min_magnitude,
    ROUND(AVG(depth_val), 1) AS avg_depth,
    SUM(tsunami_val) AS tsunami_events,
    SUM(major_val) AS major_events
FROM (
    SELECT 
        CAST(`country`['name'] AS VARCHAR) AS country_name,
        CAST(`country`['region'] AS VARCHAR) AS region,
        CAST(`country`['subregion'] AS VARCHAR) AS subregion,
        CAST(`magnitude` AS DOUBLE) AS magnitude_val,
        CAST(`depth` AS DOUBLE) AS depth_val,
        CASE WHEN `tsunami` = true THEN 1 ELSE 0 END AS tsunami_val,
        CASE WHEN `magnitude` >= 6.0 THEN 1 ELSE 0 END AS major_val
    FROM dfs.`/data/earthquakes-2025-07.json`
    WHERE `country`['name'] IS NOT NULL
    
    UNION ALL
    
    SELECT 
        CAST(`country`['name'] AS VARCHAR) AS country_name,
        CAST(`country`['region'] AS VARCHAR) AS region,
        CAST(`country`['subregion'] AS VARCHAR) AS subregion,
        CAST(`magnitude` AS DOUBLE) AS magnitude_val,
        CAST(`depth` AS DOUBLE) AS depth_val,
        CASE WHEN `tsunami` = true THEN 1 ELSE 0 END AS tsunami_val,
        CASE WHEN `magnitude` >= 6.0 THEN 1 ELSE 0 END AS major_val
    FROM dfs.`/data/earthquakes-2025-08.json`
    WHERE `country`['name'] IS NOT NULL
    
    UNION ALL
    
    SELECT 
        CAST(`country`['name'] AS VARCHAR) AS country_name,
        CAST(`country`['region'] AS VARCHAR) AS region,
        CAST(`country`['subregion'] AS VARCHAR) AS subregion,
        CAST(`magnitude` AS DOUBLE) AS magnitude_val,
        CAST(`depth` AS DOUBLE) AS depth_val,
        CASE WHEN `tsunami` = true THEN 1 ELSE 0 END AS tsunami_val,
        CASE WHEN `magnitude` >= 6.0 THEN 1 ELSE 0 END AS major_val
    FROM dfs.`/data/earthquakes-2025-09.json`
    WHERE `country`['name'] IS NOT NULL
) AS normalized_events
GROUP BY country_name, region, subregion
ORDER BY total_events DESC
LIMIT 20;

country_name	region	subregion	total_events	avg_magnitude	max_magnitude	min_magnitude	avg_depth	tsunami_events	major_events
South Korea	Asia	Eastern Asia	86	4.77	5.6	4.5	15.5	0	0
Timor-Leste	Asia	South-Eastern Asia	72	4.73	6.7	4.5	117.5	1	1
Papua New Guinea	Oceania	Melanesia	70	4.82	6.3	4.5	50.6	1	1
Tonga	Oceania	Polynesia	64	4.82	5.7	4.5	224.4	0	0
Vanuatu	Oceania	Melanesia	57	4.84	6.3	4.5	65.5	0	1
Japan	Asia	Eastern Asia	56	4.73	5.6	4.5	40.2	0	0
South Georgia	Antarctic	Unknown	45	4.82	5.5	4.5	39.2	0	0
Indonesia	Asia	South-Eastern Asia	44	4.84	6.3	4.5	68.5	0	1
Bolivia	Americas	South America	42	4.69	5.5	4.5	149.4	0	0
Philippines	Asia	South-Eastern Asia	40	4.73	5.4	4.5	73.0	0	0
Taiwan	Asia	Eastern Asia	38	4.76	5.5	4.5	27.7	0	0
Palau	Oceania	Micronesia	32	4.71	5.6	4.5	56.6	0	0
Chile	Americas	South America	31	4.74	5.9	4.5	112.0	0	0
Guam	Oceania	Micronesia	27	4.74	5.9	4.5	30.4	0	0
Falkland Islands	Americas	South America	26	4.88	7.5	4.5	10.0	1	1
Guatemala	Americas	Central America	26	4.87	5.9	4.5	36.7	0	0
Tajikistan	Asia	Central Asia	23	4.82	5.6	4.5	42.2	0	0
Fiji	Oceania	Melanesia	22	5.0	6.6	4.5	437.3	2	2
New Caledonia	Oceania	Melanesia	22	4.9	5.6	4.6	35.5	0	0
Peru	Americas	South America	22	4.78	5.6	4.5	68.3	0	0
---

-- Get distinct countries for dropdown selector
SELECT DISTINCT
    `country`['name'] AS country_name,
    `country`['region'] AS region
FROM (
    SELECT `country`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT `country`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT `country`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
WHERE `country`['name'] IS NOT NULL
ORDER BY country_name ASC;


Argentina	Americas
Aruba	Americas
Azerbaijan	Asia
Barbados	Americas
Bhutan	Asia
Bolivia	Americas
Brazil	Americas
British Indian Ocean Territory	Africa
Bulgaria	Europe
Burundi	Africa
Chile	Americas
China	Asia
Christmas Island	Oceania
Colombia	Americas
Costa Rica	Americas
Cyprus	Europe
Czechia	Europe
Djibouti	Africa
Ecuador	Americas
El Salvador	Americas
Eritrea	Africa
Ethiopia	Africa
Falkland Islands	Americas
Fiji	Oceania
Gibraltar	Europe
Greece	Europe
Greenland	Americas
Guadeloupe	Americas
Guam	Oceania
Guatemala	Americas
Iceland	Europe
Indonesia	Asia
Iran	Asia
Japan	Asia
Kyrgyzstan	Asia
Lesotho	Africa
Madagascar	Africa
Malawi	Africa
Maldives	Asia
Malta	Europe
Mauritius	Africa
Mexico	Americas
Mongolia	Asia
Morocco	Africa
Myanmar	Asia
Nepal	Asia
New Caledonia	Oceania
New Zealand	Oceania
Nicaragua	Americas
Niue	Oceania
North Korea	Asia
Northern Mariana Islands	Oceania
Oman	Asia
Pakistan	Asia
Palau	Oceania
Panama	Americas
Papua New Guinea	Oceania
Paraguay	Americas
Peru	Americas
Philippines	Asia
Portugal	Europe
Puerto Rico	Americas
Qatar	Asia
Saint Helena, Ascension and Tristan da Cunha	Africa
Samoa	Oceania
Singapore	Asia
Solomon Islands	Oceania
South Georgia	Antarctic
South Korea	Asia
Svalbard and Jan Mayen	Europe
Taiwan	Asia
Tajikistan	Asia
Tanzania	Africa
Thailand	Asia
Timor-Leste	Asia
Tonga	Oceania
Trinidad and Tobago	Americas
Tunisia	Africa
Turkey	Asia
Turkmenistan	Asia
United Arab Emirates	Asia
Uzbekistan	Asia
Vanuatu	Oceania
Vietnam	Asia
Wallis and Futuna	Oceania
Yemen	Asia

---

-- Get all earthquakes for Costa Rica
SELECT 
    `id`,
    `magnitude`,
    `depth`,
    `latitude`,
    `longitude`,
    `place`,
    `time`,
    `significance`,
    `status`,
    `felt`,
    `alert`,
    `tsunami`,
    `url`
FROM (
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `latitude`,
        `longitude`,
        `place`,
        `time`,
        `significance`,
        `status`,
        `felt`,
        `alert`,
        `tsunami`,
        `url`,
        `country`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `latitude`,
        `longitude`,
        `place`,
        `time`,
        `significance`,
        `status`,
        `felt`,
        `alert`,
        `tsunami`,
        `url`,
        `country`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `latitude`,
        `longitude`,
        `place`,
        `time`,
        `significance`,
        `status`,
        `felt`,
        `alert`,
        `tsunami`,
        `url`,
        `country`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
WHERE `country`['name'] = 'Costa Rica'
ORDER BY `time` DESC;


id	magnitude	depth	latitude	longitude	place	time	significance	status	felt	alert	tsunami	url
us6000rdjb	4.5	26	9.0498	-84.049	43 km SSE of Quepos, Costa Rica	2025-09-29T05:42:36.212Z	314	reviewed	5	null	false	https://earthquake.usgs.gov/earthquakes/eventpage/us6000rdjb
us7000qxte	4.6	10	10.6395	-86.5681	88 km WNW of Tamarindo, Costa Rica	2025-09-22T11:56:32.825Z	326	reviewed	null	null	false	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qxte
us7000qsnu	4.6	10	3.35	-84.1606	off the coast of Central America	2025-08-31T00:44:04.215Z	326	reviewed	null	null	false	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qsnu
us6000rckt	4.7	10	3.323	-84.304	off the coast of Central America	2025-08-31T00:35:13.185Z	340	reviewed	null	null	false	https://earthquake.usgs.gov/earthquakes/eventpage/us6000rckt
us6000qxhc	4.8	117	10.3608	-84.4112	4 km NNE of Quesada, Costa Rica	2025-08-01T19:33:11.811Z	360	reviewed	17	null	false	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qxhc
us7000qb1x	4.7	44	9.6741	-84.2519	7 km SSW of Tejar, Costa Rica	2025-07-06T19:59:59.379Z	367	reviewed	66	null	false	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qb1x


---

-- Comprehensive statistics for Costa Rica
SELECT 
    COUNT(*) AS total_events,
    ROUND(AVG(`magnitude`), 2) AS avg_magnitude,
    MAX(`magnitude`) AS max_magnitude,
    MIN(`magnitude`) AS min_magnitude,
    ROUND(AVG(`depth`), 1) AS avg_depth,
    MAX(`depth`) AS max_depth,
    MIN(`depth`) AS min_depth,
    SUM(CASE WHEN `magnitude` >= 5.0 THEN 1 ELSE 0 END) AS moderate_plus,
    SUM(CASE WHEN `magnitude` >= 6.0 THEN 1 ELSE 0 END) AS strong_plus,
    SUM(CASE WHEN `depth` < 70 THEN 1 ELSE 0 END) AS shallow_events,
    SUM(CASE WHEN `tsunami` = true THEN 1 ELSE 0 END) AS tsunami_events
FROM (
    SELECT 
        `magnitude`,
        `depth`,
        `tsunami`,
        `country`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT 
        `magnitude`,
        `depth`,
        `tsunami`,
        `country`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT 
        `magnitude`,
        `depth`,
        `tsunami`,
        `country`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
WHERE `country`['name'] = 'Costa Rica';

total_events	avg_magnitude	max_magnitude	min_magnitude	avg_depth	max_depth	min_depth	moderate_plus	strong_plus	shallow_events	tsunami_events
6	4.65	4.8	4.5	36.2	117	10	0	0	5	0

---

-- Distribution of earthquakes by magnitude ranges
SELECT 
    CASE 
        WHEN `magnitude` >= 4.5 AND `magnitude` < 5.0 THEN '4.5-4.9'
        WHEN `magnitude` >= 5.0 AND `magnitude` < 5.5 THEN '5.0-5.4'
        WHEN `magnitude` >= 5.5 AND `magnitude` < 6.0 THEN '5.5-5.9'
        WHEN `magnitude` >= 6.0 AND `magnitude` < 6.5 THEN '6.0-6.4'
        WHEN `magnitude` >= 6.5 AND `magnitude` < 7.0 THEN '6.5-6.9'
        WHEN `magnitude` >= 7.0 THEN '7.0+'
        ELSE 'other'
    END AS magnitude_range,
    COUNT(*) AS event_count,
    ROUND(AVG(`depth`), 1) AS avg_depth,
    ROUND(AVG(`significance`), 0) AS avg_significance
FROM (
    SELECT 
        `magnitude`,
        `depth`,
        `significance`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT 
        `magnitude`,
        `depth`,
        `significance`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT 
        `magnitude`,
        `depth`,
        `significance`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
GROUP BY 
    CASE 
        WHEN `magnitude` >= 4.5 AND `magnitude` < 5.0 THEN '4.5-4.9'
        WHEN `magnitude` >= 5.0 AND `magnitude` < 5.5 THEN '5.0-5.4'
        WHEN `magnitude` >= 5.5 AND `magnitude` < 6.0 THEN '5.5-5.9'
        WHEN `magnitude` >= 6.0 AND `magnitude` < 6.5 THEN '6.0-6.4'
        WHEN `magnitude` >= 6.5 AND `magnitude` < 7.0 THEN '6.5-6.9'
        WHEN `magnitude` >= 7.0 THEN '7.0+'
        ELSE 'other'
    END
ORDER BY magnitude_range ASC;

magnitude_range	event_count	avg_depth	avg_significance
4.5-4.9	2149	46.4	333.0
5.0-5.4	604	37.0	409.0
5.5-5.9	133	49.3	518.0
6.0-6.4	35	25.4	613.0
6.5-6.9	8	134.1	688.0
7.0+	7	33.4	1228.0

---

-- Events per day for timeline chart
SELECT 
    CAST(`time` AS DATE) AS event_date,
    COUNT(*) AS event_count,
    ROUND(AVG(`magnitude`), 2) AS avg_magnitude,
    MAX(`magnitude`) AS max_magnitude
FROM (
    SELECT 
        `time`,
        `magnitude`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT 
        `time`,
        `magnitude`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT 
        `time`,
        `magnitude`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
GROUP BY CAST(`time` AS DATE)
ORDER BY event_date ASC;

2025-07-01	19	4.63	5.1
2025-07-02	39	4.83	5.6
2025-07-03	24	4.85	5.5
2025-07-04	24	4.75	5.6
2025-07-05	16	4.75	5.5
2025-07-06	23	4.88	5.5
2025-07-07	19	4.81	6.2
2025-07-08	22	4.89	5.7
2025-07-09	17	4.74	5.3
2025-07-10	20	4.73	5.2
2025-07-11	18	4.73	5.1
2025-07-12	18	4.7	5.3
2025-07-13	20	4.75	5.3
2025-07-14	25	4.88	6.7
2025-07-15	21	4.89	5.8
2025-07-16	17	4.91	7.3
2025-07-17	23	4.92	5.6
2025-07-18	25	4.78	5.3
2025-07-19	17	4.93	5.6
2025-07-20	87	4.94	7.4
2025-07-21	48	4.77	5.8
2025-07-22	41	4.83	6.0
2025-07-23	22	4.85	6.3
2025-07-24	26	5.02	6.6
2025-07-25	21	5.0	6.2
2025-07-26	17	4.89	6.2
2025-07-27	13	4.88	5.6
2025-07-28	28	4.97	7.0
2025-07-29	68	5.13	8.8
2025-07-30	422	4.87	6.9
2025-07-31	39	4.76	6.2
2025-08-01	84	4.85	6.1
2025-08-02	63	4.73	6.0
2025-08-03	65	4.85	6.8
2025-08-04	33	4.79	6.2
2025-08-05	39	4.74	5.7
2025-08-06	40	4.74	5.8
2025-08-07	32	4.76	5.9
2025-08-08	31	4.72	5.0
2025-08-09	30	4.76	6.0
2025-08-10	46	4.74	6.1
2025-08-11	37	4.72	5.8
2025-08-12	38	4.8	6.3
2025-08-13	24	4.74	5.3
2025-08-14	20	4.81	6.3
2025-08-15	18	4.73	5.7
2025-08-16	27	4.85	5.8
2025-08-17	20	4.82	5.5
2025-08-18	26	4.77	5.6
2025-08-19	23	4.75	5.4
2025-08-20	19	4.68	5.1
2025-08-21	29	4.74	5.8
2025-08-22	29	4.89	7.5
2025-08-23	26	4.88	6.0
2025-08-24	26	4.72	5.4
2025-08-25	14	4.86	6.1
2025-08-26	20	4.84	5.6
2025-08-27	13	5.02	6.0
2025-08-28	22	4.78	5.9
2025-08-29	21	4.77	5.5
2025-08-30	15	4.83	5.5
2025-08-31	8	4.66	5.2
2025-09-01	14	4.76	5.6
2025-09-02	25	4.74	5.3
2025-09-03	26	4.81	5.9
2025-09-04	30	4.81	5.9
2025-09-05	24	4.72	5.4
2025-09-06	15	4.75	5.4
2025-09-07	21	4.7	5.1
2025-09-08	19	4.91	6.4
2025-09-09	26	4.8	5.7
2025-09-10	13	4.72	5.2
2025-09-11	23	4.75	5.3
2025-09-12	27	4.79	5.6
2025-09-13	27	4.83	7.4
2025-09-14	16	4.74	5.5
2025-09-15	19	4.82	6.0
2025-09-16	11	4.89	6.0
2025-09-17	13	4.76	5.4
2025-09-18	74	4.92	7.8
2025-09-19	79	4.79	6.0
2025-09-20	35	4.74	5.3
2025-09-21	26	4.75	5.7
2025-09-22	41	4.77	5.6
2025-09-23	25	4.78	5.6
2025-09-24	18	4.8	6.2
2025-09-25	34	4.91	6.3
2025-09-26	23	4.76	5.9
2025-09-27	24	4.73	5.5
2025-09-28	13	4.77	5.5
2025-09-29	14	4.75	5.5
2025-09-30	4	4.7	4.9

---

-- Events meeting significance criteria
SELECT 
    `id`,
    `magnitude`,
    `depth`,
    `place`,
    `time`,
    `country`['name'] AS country_name,
    `country`['region'] AS region,
    `significance`,
    `felt`,
    `alert`,
    `tsunami`,
    `status`,
    `url`,
    CASE 
        WHEN `magnitude` >= 7.0 THEN 'major'
        WHEN `magnitude` >= 6.0 THEN 'strong'
        WHEN `alert` IN ('orange', 'red') THEN 'alert'
        WHEN `tsunami` = true THEN 'tsunami'
        WHEN `felt` > 100 THEN 'widely_felt'
        ELSE 'other'
    END AS significance_category
FROM (
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `place`,
        `time`,
        `significance`,
        `felt`,
        `alert`,
        `tsunami`,
        `status`,
        `url`,
        `country`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `place`,
        `time`,
        `significance`,
        `felt`,
        `alert`,
        `tsunami`,
        `status`,
        `url`,
        `country`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT 
        `id`,
        `magnitude`,
        `depth`,
        `place`,
        `time`,
        `significance`,
        `felt`,
        `alert`,
        `tsunami`,
        `status`,
        `url`,
        `country`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
WHERE 
    `magnitude` >= 6.0 
    OR `alert` IN ('orange', 'red')
    OR `tsunami` = true
    OR `felt` > 100
ORDER BY `magnitude` DESC, `time` DESC;

id	magnitude	depth	place	time	country_name	region	significance	felt	alert	tsunami	status	url	significance_category
us6000qw60	8.8	35	2025 Kamchatka Peninsula, Russia Earthquake	2025-07-29T23:24:52.483Z	null	null	2105	124	red	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qw60	major
us7000qx2g	7.8	30	128 km E of Petropavlovsk-Kamchatsky, Russia	2025-09-18T18:58:15.240Z	Russia	Europe	1021	26	orange	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qx2g	major
us6000r2xq	7.5	10	2025 Southern Drake Passage Earthquake	2025-08-22T02:16:18.246Z	Falkland Islands	Americas	876	15	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r2xq	major
us7000qvw5	7.4	59	102 km E of Petropavlovsk-Kamchatsky, Russia	2025-09-13T02:37:56.847Z	Russia	Europe	861	23	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qvw5	major
us7000qdyl	7.4	34	2025 Eastern Kamchatka, Russia Earthquake	2025-07-20T06:49:04.327Z	null	null	2018	24	red	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qdyl	major
us7000qd1y	7.3	38	2025 Sand Point, Alaska Earthquake	2025-07-16T20:37:41.667Z	null	null	961	191	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qd1y	major
us6000qvsf	7.0	31	Macquarie Island region	2025-07-28T22:10:35.109Z	null	null	754	null	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qvsf	major
us6000qw6q	6.9	37	125 km SE of Petropavlovsk-Kamchatsky, Russia	2025-07-30T00:09:58.961Z	Russia	Europe	736	5	yellow	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qw6q	strong
us6000qxt4	6.8	30	123 km E of Severo-Kuril’sk, Russia	2025-08-03T05:37:55.148Z	Russia	Europe	717	7	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qxt4	strong
us7000qcik	6.7	71	Unknown location	2025-07-14T05:49:58.119Z	Timor-Leste	Asia	715	50	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qcik	strong
us6000qw1a	6.6	553	south of the Fiji Islands	2025-07-29T17:53:40.918Z	Fiji	Oceania	670	null	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qw1a	strong
us6000quy1	6.6	314	187 km SSE of Mata-Utu, Wallis and Futuna	2025-07-24T23:37:56.601Z	Wallis and Futuna	Oceania	670	null	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000quy1	strong
us7000qdyw	6.6	10	153 km ESE of Petropavlovsk-Kamchatsky, Russia	2025-07-20T07:07:42.573Z	Russia	Europe	671	1	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qdyw	strong
us7000qdye	6.6	23	134 km E of Petropavlovsk-Kamchatsky, Russia	2025-07-20T06:28:17.860Z	Russia	Europe	671	1	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qdye	strong
us7000qdz2	6.5	35	143 km E of Petropavlovsk-Kamchatsky, Russia	2025-07-20T07:23:02.065Z	Russia	Europe	650	1	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qdz2	strong
us7000quvp	6.4	10	Vanuatu region	2025-09-08T21:47:48.117Z	Fiji	Oceania	630	1	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000quvp	strong
us6000qvpp	6.4	21	264 km WNW of Sabang, Indonesia	2025-07-28T18:41:50.299Z	Indonesia	Asia	638	24	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qvpp	strong
us6000rcqw	6.3	14	26 km ENE of Mene Grande, Venezuela	2025-09-25T03:51:39.539Z	Venezuela	Americas	766	224	yellow	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000rcqw	strong
us6000r0sa	6.3	45	115 km SSE of Lata, Solomon Islands	2025-08-14T16:22:34.235Z	Solomon Islands	Oceania	611	1	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r0sa	strong
us6000r01m	6.3	14	195 km WNW of Abepura, Indonesia	2025-08-12T08:24:23.409Z	Indonesia	Asia	622	14	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r01m	strong
us6000qxsv	6.3	10	Pacific-Antarctic Ridge	2025-08-03T04:57:10.505Z	null	null	611	1	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qxsv	strong
us6000r0y5	6.3	16	94 km SE of Petropavlovsk-Kamchatsky, Russia	2025-07-29T23:30:03.032Z	Russia	Europe	611	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r0y5	strong
us6000qugg	6.3	142	109 km W of Gorontalo, Indonesia	2025-07-23T20:50:43.792Z	Indonesia	Asia	613	5	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qugg	strong
us6000rcnw	6.2	9	8 km ENE of Mene Grande, Venezuela	2025-09-24T22:21:55.745Z	Venezuela	Americas	859	243	yellow	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000rcnw	strong
us6000qxzw	6.2	16	202 km S of Severo-Kuril’sk, Russia	2025-08-04T04:20:54.562Z	Russia	Europe	591	1	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qxzw	strong
us6000qwuh	6.2	15	222 km SE of Severo-Kuril’sk, Russia	2025-07-31T05:27:14.789Z	Russia	Europe	591	2	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qwuh	strong
us6000qw6s	6.2	35	126 km SE of Vilyuchinsk, Russia	2025-07-30T00:16:06.520Z	Russia	Europe	591	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qw6s	strong
us6000qvbw	6.2	17	Macquarie Island region	2025-07-26T16:15:04.546Z	null	null	591	1	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qvbw	strong
us6000qv1b	6.2	10	west of Macquarie Island	2025-07-25T11:22:02.292Z	null	null	592	1	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qv1b	strong
us7000qe51	6.2	40	91 km SSE of Sand Point, Alaska	2025-07-20T22:28:00.041Z	null	null	605	25	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qe51	strong
us7000qclp	6.2	10	Unknown location	2025-07-14T17:16:49.051Z	Panama	Americas	592	3	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qclp	strong
us7000qb4s	6.2	22	213 km WSW of Riverton, New Zealand	2025-07-07T12:53:44.013Z	New Zealand	Oceania	604	23	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qb4s	strong
us6000r3l7	6.1	9	east of the Kuril Islands	2025-08-25T06:48:34.819Z	null	null	572	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r3l7	strong
us6000qznb	6.1	10	10 km WSW of Bigadiç, Turkey	2025-08-10T16:53:47.260Z	Turkey	Asia	1187	237	orange	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qznb	strong
us6000qxfn	6.1	10	215 km ESE of Severo-Kuril’sk, Russia	2025-08-01T18:20:45.177Z	Russia	Europe	572	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qxfn	strong
us6000qwfe	6.1	10	183 km SE of Vilyuchinsk, Russia	2025-07-30T09:56:13.780Z	Russia	Europe	572	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qwfe	strong
us6000r0xw	6.1	25	78 km SE of Petropavlovsk-Kamchatsky, Russia	2025-07-29T23:30:44.566Z	Russia	Europe	572	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r0xw	strong
us6000rge8	6.0	58	98 km ESE of Ozernovskiy, Russia	2025-09-19T14:55:40.913Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000rge8	strong
us7000qx1z	6.0	28	26 km S of Nabire, Indonesia	2025-09-18T18:19:49.220Z	Indonesia	Asia	558	6	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qx1z	strong
us7000qwir	6.0	63	207 km SE of Kokopo, Papua New Guinea	2025-09-16T16:59:50.035Z	Papua New Guinea	Oceania	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qwir	strong
us7000qwch	6.0	15	144 km ESE of Petropavlovsk-Kamchatsky, Russia	2025-09-15T16:34:35.213Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qwch	strong
us7000qr8h	6.0	40	92 km E of Severo-Kuril’sk, Russia	2025-08-27T03:49:50.441Z	Russia	Europe	556	4	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qr8h	strong
us6000r3at	6.0	17	88 km SW of Acajutla, El Salvador	2025-08-23T09:14:22.210Z	El Salvador	Americas	576	42	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r3at	strong
us6000qzh9	6.0	11	265 km ESE of Severo-Kuril’sk, Russia	2025-08-09T14:04:07.171Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qzh9	strong
us6000qxn6	6.0	17	165 km SSE of Vilyuchinsk, Russia	2025-08-02T14:14:03.328Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qxn6	strong
us6000qwk1	6.0	35	138 km SE of Severo-Kuril’sk, Russia	2025-07-30T16:07:46.668Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qwk1	strong
us6000qwhj	6.0	35	165 km SSE of Vilyuchinsk, Russia	2025-07-29T23:37:34.403Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qwhj	strong
us6000r0qc	6.0	35	124 km ENE of Ozernovskiy, Russia	2025-07-29T23:36:01.341Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r0qc	strong
us6000quxn	6.0	14	163 km E of Petropavlovsk-Kamchatsky, Russia	2025-07-24T22:37:27.147Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000quxn	strong
us6000qu2r	6.0	12	154 km ESE of Petropavlovsk-Kamchatsky, Russia	2025-07-22T01:59:28.404Z	Russia	Europe	554	null	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qu2r	strong
us6000rd1w	5.9	10	239 km W of Bandon, Oregon	2025-09-26T06:45:28.067Z	null	null	543	29	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000rd1w	tsunami
us7000qtm0	5.9	18	92 km SSW of Nikolski, Alaska	2025-09-03T20:57:47.645Z	null	null	536	1	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qtm0	tsunami
us7000qrj0	5.9	130	237 km W of Adak, Alaska	2025-08-28T11:07:48.125Z	null	null	536	2	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qrj0	tsunami
us7000quwy	5.7	10	174 km WSW of Port Orford, Oregon	2025-09-09T04:08:01.584Z	null	null	520	50	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000quwy	tsunami
pr2025217000	5.7	168	38 km SE of Boca de Yuma, Dominican Republic	2025-08-05T09:23:51.280Z	Dominican Republic	Americas	742	484	null	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/pr2025217000	widely_felt
us7000qbfv	5.7	10	3 km SSW of Amatitlán, Guatemala	2025-07-08T21:41:31.063Z	Guatemala	Americas	763	155	yellow	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qbfv	widely_felt
us7000qtst	5.6	17	40 km WSW of Asadābād, Afghanistan	2025-09-04T16:56:26.361Z	Afghanistan	Asia	2066	84	red	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qtst	alert
ak025b7povrc	5.6	12	133 km SE of Old Harbor, Alaska	2025-09-01T11:02:09.766Z	null	null	482	null	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/ak025b7povrc	tsunami
us7000qd4n	5.6	35	96 km SSE of Sand Point, Alaska	2025-07-17T04:30:37.038Z	null	null	482	null	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qd4n	tsunami
us7000qxp1	5.5	30	122 km SW of Adak, Alaska	2025-09-21T09:30:27.862Z	null	null	467	4	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qxp1	tsunami
us7000qw56	5.5	29	11 km ESE of Udalguri, India	2025-09-14T11:11:51.373Z	India	Asia	1072	120	orange	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qw56	alert
us7000qug7	5.4	38	81 km SSW of Nikolski, Alaska	2025-09-06T20:40:42.434Z	null	null	449	null	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qug7	tsunami
us6000qvj2	5.3	83	23 km N of Dutch Harbor, Alaska	2025-07-27T22:47:05.173Z	null	null	447	30	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qvj2	tsunami
us6000qv9g	5.3	90	Rat Islands, Aleutian Islands, Alaska	2025-07-26T05:03:53.539Z	null	null	432	null	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qv9g	tsunami
us7000qtwh	5.2	35	92 km SSW of Nikolski, Alaska	2025-09-04T19:54:26.248Z	null	null	416	1	null	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qtwh	tsunami
us7000qtvy	5.2	35	94 km SSW of Nikolski, Alaska	2025-09-04T19:01:14.016Z	null	null	416	0	null	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qtvy	tsunami
us7000qd49	5.2	35	85 km SSE of Sand Point, Alaska	2025-07-17T02:09:43.868Z	null	null	416	1	null	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qd49	tsunami
us6000rdd9	5.1	10	231 km W of Bandon, Oregon	2025-09-27T22:12:49.601Z	null	null	404	13	null	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000rdd9	tsunami
us7000qru7	5.1	81	260 km W of Adak, Alaska	2025-08-29T09:14:25.405Z	null	null	400	null	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qru7	tsunami
us6000qvdz	5.1	135	Rat Islands, Aleutian Islands, Alaska	2025-07-26T23:09:39.073Z	null	null	400	null	null	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000qvdz	tsunami
us7000qd41	5.1	37	86 km SSE of Sand Point, Alaska	2025-07-17T01:12:21.887Z	null	null	400	null	null	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qd41	tsunami
us7000quvk	5.0	10	11 km NW of Néa Stíra, Greece	2025-09-08T21:27:56.372Z	Greece	Europe	545	251	null	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000quvk	widely_felt
us7000qd00	5.0	70	57 km E of Atka, Alaska	2025-07-16T14:21:52.330Z	null	null	386	4	green	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qd00	tsunami
us6000r1j3	4.9	10	12 km ESE of Cherbourg, Australia	2025-08-15T23:49:25.053Z	Australia	Oceania	784	883	null	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us6000r1j3	widely_felt
ak025by3iekl	4.6	12	117 km SE of Old Harbor, Alaska	2025-09-17T06:35:40.812Z	null	null	326	null	null	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/ak025by3iekl	tsunami
ak025a0u3q2q	4.6	88	24 km WSW of Petersville, Alaska	2025-08-06T18:38:57.109Z	null	null	406	224	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/ak025a0u3q2q	widely_felt
nc75216737	4.5	9	74 km WNW of Ferndale, CA	2025-07-29T23:18:18.760Z	null	null	355	123	green	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/nc75216737	widely_felt
us7000qbqu	4.5	10	Unknown location	2025-07-10T03:34:48.870Z	Pakistan	Asia	490	266	null	false	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/us7000qbqu	widely_felt
ak0258jwrkyq	4.5	100	41 km WNW of Happy Valley, Alaska	2025-07-05T18:15:07.054Z	null	null	368	166	null	true	reviewed	https://earthquake.usgs.gov/earthquakes/eventpage/ak0258jwrkyq	tsunami

---

-- Scatter plot data: depth vs magnitude (without country to avoid type issues)
SELECT 
    CAST(`magnitude` AS DOUBLE) AS magnitude,
    CAST(`depth` AS DOUBLE) AS depth,
    CASE 
        WHEN `depth` < 70 THEN 'shallow'
        WHEN `depth` >= 70 AND `depth` < 300 THEN 'intermediate'
        ELSE 'deep'
    END AS depth_category,
    CAST(`significance` AS INTEGER) AS significance
FROM (
    SELECT 
        `magnitude`,
        `depth`,
        `significance`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT 
        `magnitude`,
        `depth`,
        `significance`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT 
        `magnitude`,
        `depth`,
        `significance`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
WHERE `depth` IS NOT NULL AND `magnitude` IS NOT NULL
LIMIT 1000;

magnitude	depth	depth_category	significance
4.5	10.0	shallow	312
4.6	35.0	shallow	326
4.9	10.0	shallow	369
5.6	48.0	shallow	482
6.2	15.0	shallow	591
4.5	10.0	shallow	312
4.5	26.0	shallow	312
4.9	19.0	shallow	369
4.5	10.0	shallow	312
4.5	10.0	shallow	312
... 1000

---

-- With country name properly cast
SELECT 
    CAST(`magnitude` AS DOUBLE) AS magnitude,
    CAST(`depth` AS DOUBLE) AS depth,
    CASE 
        WHEN `depth` < 70 THEN 'shallow'
        WHEN `depth` >= 70 AND `depth` < 300 THEN 'intermediate'
        ELSE 'deep'
    END AS depth_category,
    CAST(`significance` AS INTEGER) AS significance,
    CAST(`country`['name'] AS VARCHAR) AS country_name
FROM (
    SELECT 
        `magnitude`,
        `depth`,
        `significance`,
        `country`
    FROM dfs.`/data/earthquakes-2025-07.json`
    
    UNION ALL
    
    SELECT 
        `magnitude`,
        `depth`,
        `significance`,
        `country`
    FROM dfs.`/data/earthquakes-2025-08.json`
    
    UNION ALL
    
    SELECT 
        `magnitude`,
        `depth`,
        `significance`,
        `country`
    FROM dfs.`/data/earthquakes-2025-09.json`
) AS all_events
WHERE `depth` IS NOT NULL AND `magnitude` IS NOT NULL
LIMIT 1000;

---

-- Compare statistics across the 3 months
SELECT 
    '2025-07' AS month,
    COUNT(*) AS total_events,
    ROUND(AVG(`magnitude`), 2) AS avg_magnitude,
    MAX(`magnitude`) AS max_magnitude,
    ROUND(AVG(`depth`), 1) AS avg_depth,
    SUM(CASE WHEN `magnitude` >= 6.0 THEN 1 ELSE 0 END) AS major_events
FROM dfs.`/data/earthquakes-2025-07.json`

UNION ALL

SELECT 
    '2025-08' AS month,
    COUNT(*) AS total_events,
    ROUND(AVG(`magnitude`), 2) AS avg_magnitude,
    MAX(`magnitude`) AS max_magnitude,
    ROUND(AVG(`depth`), 1) AS avg_depth,
    SUM(CASE WHEN `magnitude` >= 6.0 THEN 1 ELSE 0 END) AS major_events
FROM dfs.`/data/earthquakes-2025-08.json`

UNION ALL

SELECT 
    '2025-09' AS month,
    COUNT(*) AS total_events,
    ROUND(AVG(`magnitude`), 2) AS avg_magnitude,
    MAX(`magnitude`) AS max_magnitude,
    ROUND(AVG(`depth`), 1) AS avg_depth,
    SUM(CASE WHEN `magnitude` >= 6.0 THEN 1 ELSE 0 END) AS major_events
FROM dfs.`/data/earthquakes-2025-09.json`

ORDER BY month ASC;


month	total_events	avg_magnitude	max_magnitude	avg_depth	major_events
2025-07	1239	4.87	8.8	44.0	28
2025-08	938	4.79	7.5	43.3	13
2025-09	759	4.8	7.8	46.9	9

---

-- Get distinct countries with event count for dropdown selector
SELECT 
    CAST(`country`['name'] AS VARCHAR) AS country_name,
    CAST(`country`['region'] AS VARCHAR) AS region,
    COUNT(*) AS event_count
FROM (
    SELECT `country`
    FROM dfs.`/data/earthquakes-2025-07.json`
    WHERE `country`['name'] IS NOT NULL
    
    UNION ALL
    
    SELECT `country`
    FROM dfs.`/data/earthquakes-2025-08.json`
    WHERE `country`['name'] IS NOT NULL
    
    UNION ALL
    
    SELECT `country`
    FROM dfs.`/data/earthquakes-2025-09.json`
    WHERE `country`['name'] IS NOT NULL
) AS all_events
GROUP BY 
    CAST(`country`['name'] AS VARCHAR),
    CAST(`country`['region'] AS VARCHAR)
ORDER BY event_count DESC, country_name ASC;

country_name	region	event_count
South Korea	Asia	86
Timor-Leste	Asia	72
Papua New Guinea	Oceania	70
Tonga	Oceania	64
Vanuatu	Oceania	57
Japan	Asia	56
South Georgia	Antarctic	45
Indonesia	Asia	44
Bolivia	Americas	42
Philippines	Asia	40
Taiwan	Asia	38
Palau	Oceania	32
Chile	Americas	31
Guam	Oceania	27
Falkland Islands	Americas	26
Guatemala	Americas	26
Tajikistan	Asia	23
Fiji	Oceania	22
New Caledonia	Oceania	22
Peru	Americas	22
Solomon Islands	Oceania	22
Northern Mariana Islands	Oceania	20
Singapore	Asia	19
Thailand	Asia	19
El Salvador	Americas	18
Christmas Island	Oceania	17
Myanmar	Asia	15
Ecuador	Americas	14
New Zealand	Oceania	14
Samoa	Oceania	14
China	Asia	10
Greece	Europe	10
Kyrgyzstan	Asia	10
Aruba	Americas	8
Wallis and Futuna	Oceania	8
British Indian Ocean Territory	Africa	7
Bulgaria	Europe	7
Costa Rica	Americas	6
Mauritius	Africa	6
Mexico	Americas	6
Bhutan	Asia	5
Iceland	Europe	5
Iran	Asia	5
Panama	Americas	5
Qatar	Asia	5
Svalbard and Jan Mayen	Europe	5
Eritrea	Africa	4
Nepal	Asia	4
Nicaragua	Americas	4
Colombia	Americas	3
Malta	Europe	3
Niue	Oceania	3
Pakistan	Asia	3
Tanzania	Africa	3
Djibouti	Africa	2
Greenland	Americas	2
Maldives	Asia	2
Paraguay	Americas	2
Portugal	Europe	2
Tunisia	Africa	2
Turkey	Asia	2
Turkmenistan	Asia	2
United Arab Emirates	Asia	2
Argentina	Americas	1
Azerbaijan	Asia	1
Barbados	Americas	1
Brazil	Americas	1
Burundi	Africa	1
Cyprus	Europe	1
Czechia	Europe	1
Ethiopia	Africa	1
Gibraltar	Europe	1
Guadeloupe	Americas	1
Lesotho	Africa	1
Madagascar	Africa	1
Malawi	Africa	1
Mongolia	Asia	1
Morocco	Africa	1
North Korea	Asia	1
Oman	Asia	1
Puerto Rico	Americas	1
Saint Helena, Ascension and Tristan da Cunha	Africa	1
Trinidad and Tobago	Americas	1
Uzbekistan	Asia	1
Vietnam	Asia	1
Yemen	Asia	1